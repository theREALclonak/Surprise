# This file contains common pin mappings for the BIGTREETECH SKR mini
# E3 v3.0. To use this config, the firmware should be compiled for the
# STM32G0B1 with a "8KiB bootloader" and USB communication.

# The "make flash" command does not work on the SKR mini E3. Instead,
# after running "make", copy the generated "out/klipper.bin" file to a
# file named "firmware.bin" on an SD card and then restart the SKR
# mini E3 with that SD card.

# See docs/Config_Reference.md for a description of parameters.

[include Eddy.cfg]
[include mainsail.cfg]
[include HotEnd.cfg]
#[include z_tilt.cfg]
#[include SBLED.cfg]
#[include timeout.cfg]
[include Macro.cfg]
#[include LCD.cfg]
#[include klipperExpander.cfg]
#[include lights.cfg]
#[include KAMP_Settings.cfg]
[include lights.cfg]
#[include adxl.cfg]
[exclude_object]

[input_shaper]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32g0b1xx_2A002B000C504B5735313920-if00
#canbus_uuid: 4fbce31db688 
#canbus_interface: can0

[printer]
kinematics: corexz
max_velocity: 500
max_accel: 1500
max_z_velocity: 50
max_z_accel: 1500
square_corner_velocity: 4.0

[temperature_sensor Chamber]
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PA0
min_temp: 10
max_temp: 100

[temperature_sensor BTT-Pi]
sensor_type: temperature_host
min_temp: 10
max_temp: 100

[temperature_sensor MCU]
sensor_type: temperature_mcu
min_temp: 10
max_temp: 100

[stepper_x]
step_pin: PB13
dir_pin: PB12
enable_pin: !PB14
microsteps: 16
rotation_distance: 40
endstop_pin: EBBCan:gpio24 #^PC0
position_endstop: 0
position_max: 215
homing_speed: 50

[tmc2209 stepper_x]
uart_pin: PC11
tx_pin: PC10
uart_address: 0
run_current: 0.800
#stealthchop_threshold: 999999

[stepper_y]
step_pin: PB0
dir_pin: PC5
enable_pin: !PB1
microsteps: 16
rotation_distance: 40
endstop_pin: ^PC1
position_endstop: 0
position_max: 235
homing_speed: 50

[tmc2209 stepper_y]
uart_pin: PC11
tx_pin: PC10
uart_address: 2
run_current: 0.800
#stealthchop_threshold: 999999

[stepper_z]
step_pin: PB10
dir_pin: PB2
enable_pin: !PB11
microsteps: 16
rotation_distance: 40
endstop_pin: probe:z_virtual_endstop #^PC2 
#position_endstop: 0.0
position_min: -5
position_max: 250

[safe_z_home]
home_xy_position: 110,110 #-5,275 
z_hop: 10
z_hop_speed: 5

[tmc2209 stepper_z]
uart_pin: PC11
tx_pin: PC10
uart_address: 1
run_current: 0.800
#stealthchop_threshold: 999999

#[extruder]
#step_pin: PB3
#dir_pin: !PB4
#enable_pin: !PD1
#microsteps: 16
#rotation_distance: 33.500
#nozzle_diameter: 0.400
#filament_diameter: 1.750
#heater_pin: PC8
#sensor_type: EPCOS 100K B57560G104F
#sensor_pin: PA0
#control: pid
#pid_Kp: 21.527
#pid_Ki: 1.063
#pid_Kd: 108.982
#min_temp: 0
#max_temp: 250

#[tmc2209 extruder]
#uart_pin: PC11
#tx_pin: PC10
#uart_address: 3
#run_current: 0.650

[heater_bed]
heater_pin: PC9
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PC4
#control: pid
#pid_Kp: 54.027
#pid_Ki: 0.770
#pid_Kd: 948.182
min_temp: 0
max_temp: 130

#[heater_fan heatbreak_cooling_fan]
#pin: PC7

[heater_fan controller_fan]
pin: PB15

#[fan]
#pin: PC6

[bed_screws]
screw1: 25,30
screw2: 193,30
screw3: 193,199
screw4: 25,199

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PB5,  EXP1_3=PA9,   EXP1_5=PA10, EXP1_7=PB8, EXP1_9=<GND>,
    EXP1_2=PA15, EXP1_4=<RST>, EXP1_6=PB9,  EXP1_8=PD6, EXP1_10=<5V>

# See the sample-lcd.cfg file for definitions of common LCD displays.

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3268503.638,0.087500:3268327.673,0.125000:3268113.023,
#*# 	0.175000:3267824.693,0.212500:3267333.563,0.250000:3266515.492,
#*# 	0.287500:3265634.907,0.325000:3264614.080,0.375000:3263380.278,
#*# 	0.412500:3262581.173,0.450000:3261821.517,0.487500:3261004.290,
#*# 	0.525000:3260167.725,0.575000:3259019.744,0.612500:3258236.108,
#*# 	0.650000:3257451.734,0.687500:3256601.729,0.725000:3255738.182,
#*# 	0.775000:3254760.386,0.812500:3254066.402,0.850000:3253448.354,
#*# 	0.887500:3252766.626,0.925000:3252058.724,0.975000:3251160.364,
#*# 	1.012500:3250456.717,1.050000:3249788.247,1.087500:3249068.138,
#*# 	1.125000:3248353.502,1.175000:3247548.189,1.212500:3246951.543,
#*# 	1.250000:3246399.279,1.287500:3245808.150,1.325000:3245145.597,
#*# 	1.375000:3244313.687,1.412500:3243776.026,1.450000:3243139.914,
#*# 	1.487500:3242579.604,1.525000:3241947.385,1.575000:3241255.134,
#*# 	1.612500:3240774.767,1.650000:3240327.135,1.687500:3239827.143,
#*# 	1.725000:3239315.091,1.775000:3238640.892,1.812500:3238099.775,
#*# 	1.850000:3237639.120,1.887500:3237133.385,1.925000:3236654.783,
#*# 	1.975000:3236063.918,2.012500:3235664.316,2.050000:3235267.936,
#*# 	2.087500:3234869.898,2.125000:3234446.490,2.175000:3233863.013,
#*# 	2.212500:3233434.226,2.250000:3232993.396,2.287500:3232585.925,
#*# 	2.325000:3232165.402,2.375000:3231654.214,2.412500:3231308.037,
#*# 	2.450000:3230981.215,2.487500:3230656.815,2.525000:3230299.832,
#*# 	2.575000:3229864.388,2.612500:3229523.152,2.650000:3229190.261,
#*# 	2.687500:3228837.430,2.725000:3228448.568,2.775000:3228042.165,
#*# 	2.812500:3227741.495,2.850000:3227440.663,2.887500:3227191.831,
#*# 	2.925000:3226860.731,2.975000:3226431.600,3.012500:3226101.853,
#*# 	3.050000:3225847.347,3.087500:3225563.702,3.125000:3225271.277,
#*# 	3.175000:3224909.108,3.212500:3224664.686,3.250000:3224418.656,
#*# 	3.287500:3224177.161,3.325000:3223905.085,3.375000:3223515.144,
#*# 	3.412500:3223295.701,3.450000:3223053.918,3.487500:3222814.670,
#*# 	3.525000:3222571.479,3.575000:3222241.779,3.612500:3222064.487,
#*# 	3.650000:3221863.664,3.687500:3221666.887,3.725000:3221456.698,
#*# 	3.775000:3221149.836,3.812500:3220940.033,3.850000:3220746.886,
#*# 	3.887500:3220493.456,3.925000:3220294.835,3.975000:3220000.895,
#*# 	4.012500:3219838.623,4.050000:3219670.256
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 35.344565
#*# drift_calibration =
#*# 	3306027.292518, -1523.061918, 13.792739
#*# 	3265089.917192, -160.474345, 0.257851
#*# 	3250003.243197, 67.201326, -1.994745
#*# 	3237745.703944, 277.576051, -4.087432
#*# 	3227386.482093, 445.233360, -5.626808
#*# 	3220286.166505, 514.103650, -6.216260
#*# 	3215098.308183, 558.132810, -6.674422
#*# 	3212045.638403, 549.751502, -6.530459
#*# 	3208497.145628, 586.418916, -6.873933
#*# drift_calibration_min_temp = 36.51631639488222
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.258765, -0.224948, -0.211112, -0.225514, -0.204309, -0.192127, -0.187831, -0.181028, -0.189087, -0.183708, -0.192851, -0.186458, -0.180250, -0.171573, -0.168320, -0.135267, -0.062490, 0.061509, 0.141637
#*# 	-0.131349, -0.136907, -0.156168, -0.144104, -0.143585, -0.143585, -0.145902, -0.153341, -0.153861, -0.154380, -0.156420, -0.160618, -0.156513, -0.150675, -0.142464, -0.131509, -0.150262, -0.045296, 0.147890
#*# 	-0.120960, -0.149500, -0.167812, -0.165415, -0.177267, -0.174410, -0.169014, -0.175480, -0.175360, -0.180250, -0.177387, -0.161469, -0.140066, -0.133562, -0.133056, -0.107680, -0.056700, 0.031803, 0.133818
#*# 	-0.092661, -0.094775, -0.111232, -0.121351, -0.119912, -0.130749, -0.138188, -0.136148, -0.148462, -0.148983, -0.155661, -0.132547, -0.119042, -0.095926, -0.105762, -0.117871, -0.102014, -0.020736, 0.050879
#*# 	-0.096800, -0.127910, -0.140066, -0.145385, -0.141265, -0.161055, -0.152822, -0.172771, -0.167467, -0.181328, -0.169866, -0.155979, -0.140412, -0.135108, -0.163617, -0.134587, -0.135108, -0.138945, -0.104309
#*# 	-0.082873, -0.105744, -0.114427, -0.114214, -0.101324, -0.120496, -0.133828, -0.130749, -0.145385, -0.145904, -0.153861, -0.143822, -0.127391, -0.113840, -0.131163, -0.159764, -0.167975, -0.156859, -0.174318
#*# 	-0.107502, -0.139467, -0.163870, -0.174650, -0.162855, -0.144012, -0.156673, -0.164562, -0.163709, -0.173972, -0.170026, -0.163868, -0.154622, -0.156418, -0.167213, -0.170292, -0.171919, -0.176736, -0.164377
#*# 	-0.102284, -0.116910, -0.125590, -0.139054, -0.140759, -0.143158, -0.132268, -0.132549, -0.134068, -0.147183, -0.147945, -0.148464, -0.147942, -0.136388, -0.146064, -0.164216, -0.219603, -0.243447, -0.196848
#*# 	-0.117887, -0.147609, -0.163362, -0.158738, -0.158218, -0.164376, -0.163708, -0.180973, -0.173117, -0.169014, -0.172265, -0.152219, -0.156937, -0.160538, -0.158738, -0.153858, -0.154808, -0.157697, -0.159257
#*# 	-0.161471, -0.167467, -0.164377, -0.152567, -0.144010, -0.145383, -0.140746, -0.145625, -0.137667, -0.147702, -0.136385, -0.135628, -0.139227, -0.136385, -0.140412, -0.151208, -0.156940, -0.151541, -0.158565
#*# 	-0.152579, -0.182283, -0.188967, -0.172090, -0.163615, -0.162671, -0.159420, -0.163014, -0.160112, -0.153768, -0.152915, -0.144518, -0.146145, -0.130751, -0.132549, -0.131511, -0.142119, -0.137946, -0.135626
#*# 	-0.118471, -0.131003, -0.149224, -0.144172, -0.133562, -0.134413, -0.135615, -0.140759, -0.146145, -0.144104, -0.139465, -0.136388, -0.127391, -0.117300, -0.129710, -0.128950, -0.128948, -0.128432, -0.146571
#*# 	-0.125352, -0.155820, -0.172090, -0.160803, -0.153607, -0.160110, -0.160964, -0.162668, -0.160616, -0.154618, -0.158218, -0.138705, -0.144344, -0.128951, -0.117303, -0.118154, -0.118082, -0.112986, -0.093620
#*# 	-0.120179, -0.150170, -0.157456, -0.154966, -0.146063, -0.146411, -0.150516, -0.151208, -0.156673, -0.147183, -0.130751, -0.124810, -0.112986, -0.109794, -0.122785, -0.119912, -0.113645, -0.102284, -0.101715
#*# 	-0.143585, -0.174316, -0.185686, -0.183240, -0.179414, -0.177740, -0.169682, -0.175120, -0.175360, -0.164894, -0.153341, -0.138708, -0.136388, -0.126631, -0.124542, -0.102284, -0.108639, -0.107502, -0.083246
#*# 	-0.142303, -0.162325, -0.183899, -0.173464, -0.169174, -0.165068, -0.153074, -0.156513, -0.145372, -0.143585, -0.138708, -0.124812, -0.118471, -0.094775, -0.098822, -0.104893, -0.097278, -0.085090, -0.075898
#*# 	-0.143585, -0.179654, -0.190873, -0.192554, -0.185509, -0.180733, -0.180733, -0.181923, -0.167467, -0.153420, -0.149500, -0.136388, -0.113254, -0.099089, -0.109207, -0.083417, -0.093050, -0.077371, -0.064690
#*# 	-0.114424, -0.138014, -0.170292, -0.165416, -0.163015, -0.161817, -0.150168, -0.152567, -0.148116, -0.123657, -0.110962, -0.088704, -0.078743, -0.070209, -0.059440, -0.080674, -0.073698, -0.067164, -0.056970
#*# 	-0.075440, -0.126205, -0.152063, -0.160272, -0.154115, -0.154460, -0.143505, -0.149502, -0.134590, -0.115281, -0.109794, -0.081486, -0.063862, -0.057509, -0.060559, -0.037899, -0.032465, -0.026501, -0.034897
#*# x_count = 19
#*# y_count = 19
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 10.0
#*# max_x = 209.98
#*# min_y = 30.0
#*# max_y = 210.0
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 37.796
#*# pid_ki = 13.263
#*# pid_kd = 26.929
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 52.078
#*# pid_ki = 1.291
#*# pid_kd = 525.336
